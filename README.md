# Don't Stop the Music
## Abstract

In this project, we design and implement a song recommendation system. To get the analysis data, we use two datasets, Last.fm and  Last. fm  -1K from the Million Song Dataset. Last.fm dataset contains 100k songs information while  Last.fm  -1k provides users' listening history and their brief profile collected from last.fm. We will use the KNN item-based collaborative filtering, which makes recommendations by finding similar songs in a particular user's listening history. To improve the prediction accuracy, we will try the other algorithm, Matrix factorization-based collaborative filtering, which can directly use user-item interaction matrix as training data.

## Introduction

The recommender system has many successful applications in the industry. According to statistics, 40% of Amazon's sales are generated by the recommender system; 75% of Netflix users use the recommendation system to find their favorite videos; 30% of Netflix users use keywords to search the products they need before online shopping. At present, almost all news, search, advertising, short video applications are based on the recommender system.

Our study is based on the Last.fm dataset in Million Song Dataset  and Last.fm-1k Dataset, aiming to make efficient offline music recommendations for users.  The Last.fm dataset in Million Song Dataset contains songs metadata and song-level tags, and the Last.fm-1k Dataset contains a thousand users' listening history and users profile. 

Before implementing the recommendation algorithm, we can explore the data distribution in the datasets. for example, the top k most popular songs, artists, tags, and as on,  then use MatLab to visualize then.

In this project, we plan to set up a music recommender system. Specifically, a system recommends music that the listeners would like to hear no matter they heard before or not. Our objectives include 

1) Data processing: 

The data is processed in the offline layer, i.e., using spark and other computing engines for data analysis and feature extraction. 

2) Algorithms implementation: 

We will use the KNN Item-based collaborative filtering, due to our users dataset is a listening history which is implicit feedback, thus for this algorithm, we need to convert this dataset to an explicit feedback dataset. This operation may impact the effect of the recommendation. For this reason, we will try the other algorithm Matrix factorization-based collaborative filtering, which can directly use user-item interaction matrix as training data.

3) Evaluation: 

We will use some metrics to elevalute the models, such as recall, precise, mAP and AUC.

Since recommandation system is a quite mature project, there are many related works done by researchers and developers. McFee et al. intrdouced the Million Song Dataset Challenge in 2012[1]. Amazon uses their own algorithm, item-to-item collab-orative filtering, which online computation scales independently of the number of customers andnumber of items in the product catalog [2]. In [3], Elena Shakirova had an investigation of using collaborative filtering techniques for a music recommender system and found the best result for non-trivial α=0.15 and q=3 in the item-based case, α=0.3 and q=5 in the user-based case.


## Materials and Methods

### DataSet

Our datasets come from last.fm. There are two parts of dataset, 

1. The Last.fm dataset in Million Song Dataset [4]

   http://millionsongdataset.com/lastfm/ , which provides songs metadata and song-level tags datasets.

   1) track_metadata.db

   Which contains 100k songs with track_id, title text, song_id , release time, artist_id , artist_mbid, artist_name, duration, artist_familiarit , artist_hotttnesss  year.

   2) lastfm_tags.db

   which provides a list of unique tags and a list of song-tag pairs. There are 50K unique tags and each song can have multiple tags. Now, we can get song-level data, used as item dataset  from the above two database.

2. Last.fm Dataset-1k [5]

   http://ocelma.net/MusicRecommendationDataset/lastfm-1K.html, which provides users' listening history  and  users' brief profile collected from last.fm.  The listening history contains almost 2000k lines with <index, user_id, timestamp, artist_id, artist_name, track_id, track_name> tuple, in which has almost 1k users. The user profile data contains 1k users with <userid, gender, age, country, signup time>.



### Data Analysis

#### Clean data

The listening history dataset is very huge, has 2000k records, which contains a large number of not useful data. So the first step is to extract useful data, intersection the listening history and songs dataset, thus we can just keep the history that has responding songs in the songs dataset. After the intersect operation, the listening history dataset is reduced to 800k lines and the songs dataset is reduced to 20k lines.

#### Data visualization

Before we starting the algorithm, we can have a look at the dataset distribution. For songs, we can statistic the top k most popular songs, artists, tags, countries and, so on. For users, we can statistic the gender proportions and aged distribution. we can use the MatLab library to visualize those statistic results.

### Recommendation Algorithm

1. #### KNN Item based collaborative filtering 

   For implementing item-based collaborative filtering, we need two kinds of data, users feature and items feature. Feature engineering can help, our plan is to extract song features and user features from the song-tag dataset and user listening history. This is a very preliminary method that will lose the listening sequence information. When data is ready, we can build a song-user matrix and use sklearn.neighbors.NearestNeighbors to train the model.

2. #### Matrix factorization-based collaborative filtering

   The users listening history is a user behavior dataset, which doesn't explicitly reflect the taste of users, thus it's called implicit feedback. If we use the statistic method to construct user preferences, can lose some information contained in listening history. 
   For implicit feedback, we can use matrix factorization-based collaborative filtering to implement a recommendations system. Spark.mllib.recommendation.ALS model is a good choice to handle implicit feedback dataset, the model can find latent factors in the listening history dataset.

3. #### Evaluation

   We will use some metrics to elevalute the models, such as recall, precise, mAP and AUC.



##  Reference
[1] B.  McFee,  T.  Bertin-Mahieux,  D.  P.  W.  Ellis,  G.  R.  G.  Lanckriet,  The  million  song  datasetchallenge, in: Mille et al. [74], pp. 909–916.

[2] Linden, G., Smith, B. and York, J. (2003). Amazon.com Recommendations Item-to-Item Collaborative Filtering. [ebook] Available at:https://www.cs.umd.edu/~samir/498/Amazon-Recommendations.pdf[Accessed 10 Oct. 2017]

[3] E. Shakirova, "Collaborative filtering for music recommender system," 2017 IEEE Conference of Russian Young Researchers in Electrical and Electronic Engineering (EIConRus), St. Petersburg, 2017, pp. 548-550, doi: 10.1109/EIConRus.2017.7910613.

[4] Thierry Bertin-Mahieux, Daniel P.W. Ellis, Brian Whitman, and Paul Lamere, June 14, 2016, "Million Song Dataset", IEEE Dataport, doi: https://dx.doi.org/10.5072/FK27D2W31V.

[5] last.fm, https://www.last.fm/home



